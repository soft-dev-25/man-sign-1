name: .NET Unit Tests
on:
    push:
        branches: [ "feat/get-adress-ci" ]
        paths:
            - backend/api/Models/Address.cs
            - backend/getAddressTest/UnitTest/**

    jobs:
        unit-tests-getAddress:
            runs-on: ubuntu-latest
            steps:
                - name: Checkout code
                  uses: actions/checkout@v4

                - name: Cache NuGet packages
                  uses: actions/cache@v4
                  with:
                      path: ~/.nuget/packages
                      key: ${{ runner.os }}-nuget-${{ hashFiles('**/packages.lock.json') }}
                      restore-keys: |
                          ${{ runner.os }}-nuget-

                - name: Setup .NET
                  uses: actions/setup-dotnet@v4
                  with:
                      dotnet-version: "9.0.x"
                - name: Restore dependencies
                  run: dotnet restore ./backend/getAddressTest/getAddressTest.csproj
                - name: Build project
                  run: dotnet build --no-restore ./backend/getAddressTest/getAddressTest.csproj --configuration Release
                - name: Run unit tests
                  run: dotnet test ./backend/getAddressTest/getAddressTest.csproj --filter "TestCategory=IntegrationDbTest" --configuration Release --no-build --logger "trx;LogFileName=test-results.trx" --results-directory ./TestResults
